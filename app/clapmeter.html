<html>
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="" />
    <meta name="author" content="Rexhep Shijaku" />
    <meta name="viewport" content="width=device-width; initial-scale=1.0" />
    <script
      src="https://cdn.socket.io/4.5.0/socket.io.min.js"
      integrity="sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k"
      crossorigin="anonymous"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity=" sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script type="text/javascript" src="./js/svg-gauge/gauge.min.js"></script>
    <link rel="stylesheet" href="./css/style.css" />
  </head>
  <body>
    <div class="container">
      <div class="">
        <center><img src="/media/logo.png" /></center>
      </div>
      <div id="gauge" class="gauge-container"></div>
    </div>
  </body>
</html>

<script>
  let gauge;

  createGauge();

  function createGauge() {
    const Gauge = window.Gauge;

    // Create a new Gauge
    const GAUGE_MAX = 5;
    gauge = Gauge(document.getElementById('gauge'), {
      max: GAUGE_MAX,
      // custom label renderer
      label: function (value) {
        return `${parseInt(Math.ceil(value), 10)} 👏`;
      },
      value: 0,
      // Custom dial colors (Optional)
      color: function (value) {
        if (value >= GAUGE_MAX) {
          return '#ef4655'; // red
        } else if (value > GAUGE_MAX - GAUGE_MAX * 0.1) {
          return '#f7aa38'; // orange
        } else if (value > GAUGE_MAX - GAUGE_MAX * 0.5) {
          return '#fffa50'; // yellow
        } else {
          return '#5ee432'; // green
        }
      },
    });
  }

  var socket = io();
  socket.on('clapmeter', (value) => {
    gauge.setValueAnimated(value);
  });
  socket.on('clapmeter-reset', () => {
    gauge.setValue(0);
  });
</script>
